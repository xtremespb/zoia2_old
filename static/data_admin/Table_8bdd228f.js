(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{605:function(e,t,a){},612:function(e,t,a){"use strict";a.r(t);var n=a(50),r=a.n(n),o=a(113),s=a.n(o),i=a(51),l=a.n(i),c=a(52),d=a.n(c),u=a(20),p=a.n(u),m=a(53),g=a.n(m),h=a(5),f=a.n(h),v=a(0),k=a.n(v),E=a(1),b=a.n(E),S=function(e){function t(){var e,a;r()(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return a=l()(this,(e=d()(t)).call.apply(e,[this].concat(o))),f()(p()(a),"handleChange",(function(e){e.preventDefault();var t=parseInt(e.currentTarget.getAttribute("data-page"),10);a.props.pageClickHandler&&"function"==typeof a.props.pageClickHandler?a.props.pageClickHandler(t):console.log("No handleChange() for Pagination component is set")})),f()(p()(a),"generatePaginationRange",(function(){if(a.props.totalPages<=1)return"";for(var e=[],t=Math.max(2,a.props.page-2);t<=Math.min(a.props.totalPages-1,a.props.page+2);t+=1)a.props.page===t?e.push(k.a.createElement("li",{className:"uk-active ztable-page-active",key:"page_".concat(t)},t)):e.push(k.a.createElement("li",{key:"page_".concat(t)},k.a.createElement("a",{onClick:a.handleChange,"data-page":t,href:"#"},t)));return a.props.page-2>2&&e.unshift(k.a.createElement("li",{key:"page_dots1"},"...")),a.props.page+2<a.props.totalPages-1&&e.push(k.a.createElement("li",{key:"page_dots2"},"...")),1===a.props.page?e.unshift(k.a.createElement("li",{className:"uk-active ztable-page-active",key:"page_1"},"1")):e.unshift(k.a.createElement("li",{key:"page_1"},k.a.createElement("a",{onClick:a.handleChange,"data-page":"1",href:"#"},"1"))),e.push(a.props.page===a.props.totalPages?k.a.createElement("li",{className:"uk-active ztable-page-active",key:"page_".concat(a.props.totalPages)},a.props.totalPages):k.a.createElement("li",{key:"page_".concat(a.props.totalPages)},k.a.createElement("a",{href:"#",onClick:a.handleChange,"data-page":a.props.totalPages},a.props.totalPages))),e})),f()(p()(a),"render",(function(){return k.a.createElement("ul",{className:"uk-pagination ztable-noselect","uk-margin":"uk-margin"},a.generatePaginationRange())})),a}return g()(t,e),t}(v.Component),C=function(e){return k.a.createElement("th",{className:"uk-text-nowrap ztable-th".concat(e.sortable?" ztable-th-sortable":""," ").concat(e.prefix,"-th ").concat(e.css||""),"data-id":e.thid,onClick:e.thOnClickHandler},e.title,e.sortable?k.a.createElement("span",null," ",k.a.createElement("span",{"uk-icon":"triangle-".concat("desc"===e.sort?"up":"down"),style:e.sort?{opacity:"1"}:{opacity:"0"}})):null)},y=a(588),M=a.n(y),x=function(e){function t(){var e,a;r()(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return a=l()(this,(e=d()(t)).call.apply(e,[this].concat(o))),f()(p()(a),"state",{value:a.props.initialValue||""}),f()(p()(a),"onValueChangedDebounced",M()((function(e){return a.props.onValueChanged(e)}),500)),f()(p()(a),"onValueChanged",(function(e){var t=e.target.value;a.setState({value:t}),a.props.onValueChanged&&"function"==typeof a.props.onValueChanged&&a.onValueChangedDebounced(t)})),f()(p()(a),"setValue",(function(e){return a.setState({value:e})})),a}return g()(t,e),s()(t,[{key:"render",value:function(){var e=this;return k.a.createElement("div",{className:"uk-margin"},k.a.createElement("form",{className:"uk-search uk-search-default",onSubmit:function(e){return e.preventDefault()}},k.a.createElement("span",{className:"uk-form-icon uk-form-icon-flip","uk-icon":"icon:search"}),k.a.createElement("input",{className:"uk-search-input",type:"search",value:this.state.value,onChange:function(t){return e.onValueChanged(t)}})))}}]),t}(v.Component),I=function(){return k.a.createElement("div",{className:"ztable-loading"},k.a.createElement("span",{"uk-spinner":"ratio:2"}))};a(605);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(a,!0).forEach((function(t){f()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a.d(t,"default",(function(){return N}));var _=0,P=1,D=2,N=function(e){function t(e){var a;if(r()(this,t),a=l()(this,d()(t).call(this,e)),f()(p()(a),"state",{data:[],columns:[],page:1,checkboxes:{},checkboxAllChecked:!1,currentChunk:[],searchText:"",total:0,editMode:{columnId:null,recordId:null,value:null,loading:!1},values:{},currentSearchInputValue:"",validationError:_,mounted:!1}),f()(p()(a),"componentDidMount",(function(){document.addEventListener("keydown",a.onEditModeEscapeBinding),a.props.initialState&&!a.props.initialState.loading&&Object.keys(a.props.initialState).length?a.setState(R({},a.props.initialState,{loading:!1,loadingText:!1}),(function(){a.props.initialState.searchText&&a.usersTableSearchField.current.setValue(a.props.initialState.searchText);var e=a.props.initialState.columns.map((function(e,t){var n=e;return n.process=a.props.columns[t].process,n}));a.setState({columns:e}),a.mounted=!0})):a.mounted=!0})),f()(p()(a),"componentWillUnmount",(function(){a.mounted=!1})),f()(p()(a),"componentDidUpdate",(function(e,t){a.mounted&&t!==a.state&&a.props.onStateUpdated&&"function"==typeof a.props.onStateUpdated&&a.props.onStateUpdated(a.state)})),f()(p()(a),"setLoading",(function(e){a.mounted&&a.setState({loading:e})})),f()(p()(a),"setValuesFromData",(function(e,t){var n=a.props.source.url&&e.length>a.props.itemsPerPage?e.slice((a.state.page-1)*a.props.itemsPerPage,(a.state.page-1)*a.props.itemsPerPage+parseInt(a.props.itemsPerPage,10)):e,r={};n.map((function(e){a.state.columns.map((function(t){var a=e[t.id]||" ";a=t.process&&"function"==typeof t.process?t.process(e[t.id],e):a,r[t.id]=r[t.id]||{},r[t.id][e._id]=a}))})),t?a.state.values=r:a.mounted&&a.setState({values:r})})),f()(p()(a),"reloadURL",(function(){a.fetchURL(!1,{page:a.props.initialState.page,searchText:a.props.initialState.searchText,sortColumn:a.props.initialState.sortColumn,sortDirection:a.props.initialState.sortDirection})})),f()(p()(a),"onCellValueClick",(function(e,t){var n=JSON.parse(e.currentTarget.dataset.col);if(n.editable){var r=JSON.parse(e.currentTarget.dataset.item);a.mounted&&a.setState({editMode:{columnId:n.id,recordId:r._id,value:t,loading:!1},validationError:_},(function(){a["editField_".concat(n.id,"_").concat(r._id)].focus()}))}})),f()(p()(a),"onEditModeInputBlur",(function(){a.mounted&&a.setState({editMode:{columnId:null,recordId:null}})})),f()(p()(a),"onEditModeInputKeypress",(function(e,t){if("Enter"===e.key){if(a.state.editMode.value=a.state.editMode.value.trim(),t.validation){if(t.validation.mandatory&&!a.state.editMode.value&&a.mounted)return void a.setState({validationError:P});if(t.validation.regexp&&a.state.editMode.value)if(!new RegExp(t.validation.regexp).test(a.state.editMode.value))return void(a.mounted&&a.setState({validationError:D}))}a.mounted&&a.setState({editMode:{columnId:a.state.editMode.columnId,recordId:a.state.editMode.recordId,value:a.state.editMode.value,loading:!0}},(function(){a.saveData(a.state.editMode.columnId,a.state.editMode.recordId,a.state.editMode.value)}))}})),f()(p()(a),"onEditModeInputChange",(function(e){var t=e.target.value,n=JSON.parse(JSON.stringify(a.state.editMode));n.value=t,a.mounted&&a.setState({editMode:n})})),f()(p()(a),"onEditModeSelectChange",(function(e){var t=e.target.value;a.mounted&&a.setState({editMode:{columnId:a.state.editMode.columnId,recordId:a.state.editMode.recordId,value:t,loading:!0}},(function(){a.saveData(a.state.editMode.columnId,a.state.editMode.recordId,a.state.editMode.value)}))})),f()(p()(a),"onEditModeEscapeBinding",(function(e){a.mounted&&"Escape"===e.key&&a.state.editMode.columnId&&a.setState({editMode:{columnId:null,recordId:null,value:null,loading:!1}})})),f()(p()(a),"onEditModeSelectKeypress",(function(e){"Enter"===e.key&&a.onEditModeSelectChange(e)})),f()(p()(a),"getEditableFieldsErrorMessage",(function(e){var t;switch(e){case D:t=a.props.lang.ERR_VFORMAT;break;default:t=a.props.lang.ERR_VMANDATORY}return a.state.validationError!==_?k.a.createElement("div",null,k.a.createElement("span",{className:"uk-label uk-label-danger"},t)):null})),f()(p()(a),"getEditableFields",(function(e,t){switch(e.editable){case"select":return k.a.createElement("select",{onKeyPress:a.onEditModeSelectKeypress,onChange:a.onEditModeSelectChange,value:a.state.values[e.id][t._id],onBlur:a.onEditModeInputBlur,className:"uk-select ztable-editmode-select uk-width-1-1",ref:function(n){a["editField_".concat(e.id,"_").concat(t._id)]=n}},Object.keys(e.options).map((function(n){return k.a.createElement("option",{key:"editSelectOption_".concat(e.id,"_").concat(t._id,"_").concat(n),value:n},a.props.i18n._(e.options[n]))})));default:return k.a.createElement(k.a.Fragment,null,k.a.createElement("input",{ref:function(n){a["editField_".concat(e.id,"_").concat(t._id)]=n},type:"text",className:"uk-input ztable-editmode-input uk-width-1-1".concat(a.state.validationError!==_?" uk-form-danger":null),onChange:a.onEditModeInputChange,value:a.state.editMode.value,onKeyPress:function(t){return a.onEditModeInputKeypress(t,e)},onBlur:a.onEditModeInputBlur}),a.getEditableFieldsErrorMessage(a.state.validationError))}})),f()(p()(a),"getCell",(function(e,t,n){var r=e.editable?"select"===e.editable?a.props.i18n._(e.options[a.state.values[e.id]?a.state.values[e.id][t._id]:""]):a.state.values[e.id]?a.state.values[e.id][t._id]:"":n;return k.a.createElement(k.a.Fragment,null,a.state.editMode.loading&&a.state.editMode.columnId===e.id&&a.state.editMode.recordId===t._id?k.a.createElement("div",{"uk-spinner":"ratio:0.5"}):k.a.createElement("div",{className:"ztable-cell",tabIndex:e.editable?0:null,onClick:function(n){return a.onCellValueClick(n,a.state.values[e.id]?a.state.values[e.id][t._id]:null)},"data-col":JSON.stringify(e),"data-item":JSON.stringify(t),role:e.editable?"button":null},r||" "))})),f()(p()(a),"getRows",(function(){return a.state.currentChunk=a.state.data.length>a.props.itemsPerPage?a.state.data.slice((a.state.page-1)*a.props.itemsPerPage,(a.state.page-1)*a.props.itemsPerPage+parseInt(a.props.itemsPerPage,10)):a.state.data,!!a.state.currentChunk.length&&a.state.currentChunk.map((function(e){var t=a.state.columns.map((function(t){var n=e[t.id]||" ";return n=t.process&&"function"==typeof t.process?t.process(e[t.id],e):n,k.a.createElement("td",{key:"".concat(a.props.prefix,"_td_").concat(t.id),className:t.cssRow||null},a.state.editMode.loading||a.state.editMode.columnId!==t.id||a.state.editMode.recordId!==e._id?a.getCell(t,e,n):a.getEditableFields(t,e))})),n=a.props.hideColumnID?null:k.a.createElement("td",{className:"uk-table-shrink"},k.a.createElement("input",{onChange:a.checkboxChangeHandler,className:"uk-checkbox",type:"checkbox","data-id":e._id,checked:!!a.state.checkboxes[e._id]}));return k.a.createElement("tr",{key:"".concat(a.props.prefix,"_tr_").concat(e._id)},n,t)}))})),f()(p()(a),"checkboxChangeHandler",(function(e){var t=e.currentTarget.getAttribute("data-id"),n=a.state.checkboxes;n[t]=n[t]?null:a.state.currentChunk.find((function(e){return String(e._id)===t})),Object.keys(n).map((function(e){n[e]||delete n[e]})),a.mounted&&a.setState({checkboxes:n}),a.getCheckboxData()})),f()(p()(a),"checkboxChangeAllHandler",(function(e){var t={};a.state.currentChunk.map((function(a){return t[a._id]=e.currentTarget.checked?a:null})),Object.keys(t).map((function(e){t[e]||delete t[e]})),a.mounted&&a.setState({checkboxes:t,checkboxAllChecked:e.currentTarget.checked}),a.getCheckboxData()})),f()(p()(a),"getCheckboxData",(function(){var e=Object.keys(a.state.checkboxes).map((function(e){return a.state.checkboxes[e]}));return Object.keys(a.state.values).map((function(t){e.map((function(n,r){e[r][t]=a.state.values[t][n._id]||e[r][t]}))})),e})),f()(p()(a),"getCurrentData",(function(){return a.state.values})),f()(p()(a),"pageClickHandler",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.page;a.mounted&&a.setState({page:e,checkboxes:{},checkboxAllChecked:!1},(function(){a.props.source.url&&a.fetchURL(!1)}))})),f()(p()(a),"thOnClickHandler",(function(e){var t=e.currentTarget.getAttribute("data-id"),n=a.state.columns.find((function(e){return!!e.sort})),r=a.state.columns.find((function(e){return e.id===t}));if(r.sortable){var o,s=r.id===n.id?a.state.columns.map((function(e){var t=e;return t.sort=t.id===n.id?"desc"===t.sort?"asc":"desc":t.sort,o=o||t.sort,t})):a.state.columns.map((function(e){var t=e;return t.sort=t.id===r.id?"desc":null,o=o||t.sort,t}));if(a.mounted&&a.props.source.url)a.setState({sortColumn:t,sortDirection:o},(function(){a.fetchURL(!1)}));else{var i=a.state.data.slice(0);i.sort((function(e,t){return e[r.id]>t[r.id]?"desc"===o?-1:1:t[r.id]>e[r.id]?"desc"===o?1:-1:0})),a.mounted&&a.setState({columns:s,data:i})}}})),f()(p()(a),"onSearchValueChanged",(function(e){if(a.mounted&&a.props.source.url)a.setState({searchText:e.trim(),currentSearchInputValue:e.trim(),data:[],loadingText:!0,page:1},(function(){a.fetchURL(!1)}));else{var t=e.length>0?a.props.data.filter((function(t){return Object.values(t).find((function(t){return String(t).match(new RegExp(e,"gim"))}))})):a.props.data.slice(0);a.mounted&&a.setState({searchText:e.trim(),currentSearchInputValue:e.trim(),data:t,total:t.length,page:1})}})),f()(p()(a),"onClickRefreshHandler",(function(e){e.preventDefault(),a.mounted&&a.setState({error:!1,loadingText:!0}),a.fetchURL(!1)})),f()(p()(a),"render",(function(){return k.a.createElement("div",{className:"ztable-wrap"},k.a.createElement("div",{"uk-grid":"true"},k.a.createElement("div",{className:"uk-width-expand@s"},a.props.topButtons||null),k.a.createElement("div",{className:"uk-width-auto@s"},k.a.createElement(x,{ref:a.usersTableSearchField,currentSearchInputValue:a.state.currentSearchInputValue,onValueChanged:a.onSearchValueChanged}))),k.a.createElement(S,{page:a.state.page,totalPages:Math.ceil(a.state.total/a.props.itemsPerPage),pageClickHandler:a.pageClickHandler}),k.a.createElement("div",{className:"uk-overflow-auto"},k.a.createElement("table",{className:"uk-table uk-table-middle uk-table-small uk-table-striped uk-table-hover"},k.a.createElement("thead",null,k.a.createElement("tr",null,a.props.hideColumnID?null:k.a.createElement("th",{className:"uk-table-shrink"},k.a.createElement("label",null,k.a.createElement("input",{type:"checkbox",className:"uk-checkbox",checked:a.state.checkboxAllChecked,onChange:a.checkboxChangeAllHandler}))),a.state.columns.map((function(e){return k.a.createElement(C,{key:e.id,prefix:a.props.prefix,css:e.cssHeader,thid:e.id,title:a.props.i18n._(e.title),sortable:e.sortable,sort:e.sort,thOnClickHandler:a.thOnClickHandler})})))),k.a.createElement("tbody",null,a.state.loadingText?k.a.createElement("tr",null,k.a.createElement("td",{colSpan:"100%"},a.props.lang.LOADING)):a.state.error?null:a.getRows()||k.a.createElement("tr",null,k.a.createElement("td",{colSpan:"100%"},a.props.lang.NO_RECORDS)),a.state.error?k.a.createElement("tr",null,k.a.createElement("td",{colSpan:"100%",className:"ztable-td-error"},a.props.lang.ERROR_LOAD," ",k.a.createElement("button",{type:"button",onClick:a.onClickRefreshHandler,"uk-icon":"icon:refresh;ratio:0.8"}))):null))),k.a.createElement("div",{"uk-grid":"true",className:"uk-margin-top"},k.a.createElement("div",{className:"uk-width-expand@s"},k.a.createElement(S,{page:a.state.page,totalPages:Math.ceil(a.state.total/a.props.itemsPerPage),pageClickHandler:a.pageClickHandler}))),a.state.loading?k.a.createElement(I,null):null)})),a.usersTableSearchField=k.a.createRef(),!a.props.initialState||!Object.keys(a.props.initialState).length||a.props.initialState.loading)if(a.state.columns=e.columns,a.props.columns.map((function(e){var t=e;t.sort=a.props.sortColumn===t.id?a.props.sortDirection:null,a.state.values[e.id]={}})),e.source.url)a.fetchURL(!0);else{a.state.data=e.data,a.state.total=e.data.length;var n=a.state.columns.find((function(e){return!!e.sort}));if(n)a.state.data.slice(0).sort((function(e,t){return e[n.id]>t[n.id]?"desc"===n.sort?-1:1:t[n.id]>e[n.id]?"desc"===n.sort?1:-1:0}));a.setValuesFromData(a.state.data,!0)}return a}return g()(t,e),s()(t,[{key:"fetchURL",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e?(this.state.loading=!0,this.state.loadingText=!0):this.mounted&&this.setState({loading:!0});var n=R({},this.props.source.extras,{page:a.page||this.state.page,search:a.searchText||this.state.searchText,itemsPerPage:this.props.itemsPerPage,sortColumn:a.sortColumn||this.state.sortColumn||this.props.sortColumn||"",sortDirection:a.sortDirection||this.state.sortDirection||this.props.sortDirection||""});this.props.axios({method:this.props.source.method,url:this.props.source.url,responseType:"json",data:n,params:this.props.source.method.match(/get/i)?n:null}).then((function(e){200!==e.data.statusCode&&t.mounted?t.setState({error:!0,loading:!1,loadingText:!1,data:[]},(function(){t.props.onLoadError&&"function"==typeof t.props.onLoadError&&t.props.onLoadError(e.data)})):(t.mounted&&t.setState({data:e.data.items,total:e.data.total,loading:!1,loadingText:!1,error:!1},(function(){e.data.items.length?window.scrollTo(0,1):1!==t.state.page&&t.mounted&&t.setState({page:1},(function(){t.fetchURL(!1)}))})),t.setValuesFromData(e.data.items))})).catch((function(e){t.mounted&&t.setState({error:!0,loading:!1,loadingText:!1,data:[]},(function(){return t.props.onLoadError(e&&e.response?e.response:{})}))}))}},{key:"saveData",value:function(e,t,a){var n=this,r=R({},this.props.source.extras,{columnId:e,recordId:t,value:a});this.props.axios({method:this.props.save.method,url:this.props.save.url,responseType:"json",data:r,params:this.props.save.method.match(/get/i)?r:null}).then((function(e){if(200!==e.data.statusCode)return n.props.onSaveError&&"function"==typeof n.props.onSaveError?n.props.onSaveError(e.data):n.props.UIkit.notification(e.data.errorMessage||n.props.lang.ERROR_SAVE,{status:"danger"}),void(n.mounted&&n.setState({editMode:{columnId:null,recordId:null,value:null,loading:!1}}));var t=JSON.parse(JSON.stringify(n.state.values));t[n.state.editMode.columnId][n.state.editMode.recordId]=e.data.value,n.mounted&&n.setState({editMode:{columnId:null,recordId:null,value:null,loading:!1},values:t})})).catch((function(e){n.props.onSaveError&&"function"==typeof n.props.onSaveError?n.props.onSaveError(null,e):n.props.UIkit.notification(n.props.lang.ERROR_SAVE,{status:"danger"}),n.mounted&&n.setState({editMode:{columnId:null,recordId:null,value:null,loading:!1}})}))}}]),t}(v.Component);f()(N,"propTypes",{prefix:b.a.string.isRequired,columns:b.a.arrayOf(b.a.object).isRequired,lang:b.a.objectOf(b.a.string),itemsPerPage:b.a.number.isRequired,source:b.a.oneOfType([b.a.string,b.a.object]),save:b.a.oneOfType([b.a.string,b.a.object]),data:b.a.arrayOf(b.a.object),sortColumn:b.a.string,sortDirection:b.a.string,hideColumnID:b.a.bool,UIkit:b.a.func.isRequired,axios:b.a.func.isRequired,onLoadError:b.a.func,onSaveError:b.a.func,i18n:b.a.oneOfType([b.a.string,b.a.object,b.a.func]).isRequired,initialState:b.a.oneOfType([b.a.string,b.a.object]),onStateUpdated:b.a.func}),f()(N,"defaultProps",{hideColumnID:!1,sortDirection:"asc",sortColumn:"",data:[],source:{},save:{},lang:{LOADING:"Loading data, please wait…",NO_RECORDS:"No records to display",ERROR_LOAD:"Could not load data",ERROR_SAVE:"Could not save data",ERR_VMANDATORY:"Field is required",ERR_VFORMAT:"Invalid format"},onLoadError:null,onSaveError:null,initialState:null,onStateUpdated:null})}}]);